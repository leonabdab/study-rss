"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAllData=exports.getRssEmailData=exports.postData=void 0;var _rss=require("./rss.js"),_email=require("./email.js"),email=$("#email"),rssInput=$("#rss-input"),contentType="application/json; charset=utf-8",postData=function(){var t,s,r,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=JSON.stringify({rss:rssInput.val(),email:email.val()}),e.next=4,regeneratorRuntime.awrap(fetch("/data",{method:"post",headers:{"Content-Type":contentType},body:t}));case 4:return s=e.sent,e.next=7,regeneratorRuntime.awrap(s.json());case 7:if(r=e.sent)return n=(0,_rss.buildIDs)(r),_rss.rssList.append(linkTemplate(r,n)),rssInput.val(""),(0,_rss.editRssLink)(r,n.rssLinkId,n.editId),(0,_rss.deleteRssLink)(r,n.rssListItemId,n.deleteId),e.abrupt("return",r);e.next=15;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Unexpected error: ".concat(e.t0.message,". Try again"));case 20:case"end":return e.stop()}},null,null,[[0,17]])};exports.postData=postData;var getRssEmailData=function(){var t,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(fetch("/data",{method:"get"}));case 3:return t=e.sent,e.next=6,regeneratorRuntime.awrap(t.json());case 6:if(s=e.sent)return e.abrupt("return",s);e.next=9;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Unexpected error: ".concat(e.t0.message,". Try again"));case 14:case"end":return e.stop()}},null,null,[[0,11]])};exports.getRssEmailData=getRssEmailData;var getAllData=function(){var t,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(fetch("/data/all",{method:"get"}));case 3:return t=e.sent,e.next=6,regeneratorRuntime.awrap(t.json());case 6:if(s=e.sent)return displayRssLinkList(s),(0,_email.makeEmailReadOnly)(s),e.abrupt("return",s);e.next=11;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Unexpected error: ".concat(e.t0.message,". Try again"));case 16:case"end":return e.stop()}},null,null,[[0,13]])};exports.getAllData=getAllData;var linkTemplate=function(e,t){return'\n    <li id="'.concat(t.rssListItemId,'" class="list-group-item">\n      <div class="row">\n         <div id="').concat(t.rssLinkId,'" class="col-md-4">').concat(e.rss,'</div>\n         <div class="col-md-4"></div>\n         <div class="col-md-4 text-right">\n          <button id="').concat(t.editId,'" class="btn btn-secondary rss-list__button">Edit</button>\n          <button id="').concat(t.deleteId,'" class="btn btn-danger rss-list__button">Delete</button>\n        </div>\n      </div>\n    </li>')},displayRssLinkList=function(e){e.forEach(function(e){if(e.rss){var t=(0,_rss.buildIDs)(e);_rss.rssList.append(linkTemplate(e,t)),(0,_rss.editRssLink)(e,t.rssLinkId,t.editId),(0,_rss.deleteRssLink)(e,t.rssListItemId,t.deleteId)}})};